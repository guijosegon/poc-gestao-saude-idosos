@model GestaoSaudeIdosos.Web.ViewModels.PacienteDetalheViewModel
@{
    ViewData["Title"] = "Detalhes do paciente";
}

<section class="page-header">
    <div class="page-header__profile">
        <img src="@(string.IsNullOrWhiteSpace(Model.ImagemPerfil) ? Url.Content("~/images/avatar-generico.svg") : Model.ImagemPerfil)"
             alt="Foto de @Model.NomeCompleto"
             class="avatar avatar-lg" />
        <div>
            <h1>@Model.NomeCompleto</h1>
            <p class="page-subtitle">Código: @Model.PacienteId • @Model.Idade anos • CPF/RG: @(string.IsNullOrWhiteSpace(Model.CpfRg) ? "—" : Model.CpfRg)</p>
            <p class="page-subtitle">Acompanhamento por @(string.IsNullOrEmpty(Model.Responsavel) ? "—" : Model.Responsavel)</p>
        </div>
    </div>
    <div class="page-actions">
        <a asp-action="Edit" asp-route-id="@Model.PacienteId" class="btn-primary"
           data-open-tab data-tab="Pacientes"
           data-url='@Url.Action("Edit", "Pacientes", new { id = Model.PacienteId })'>Editar</a>
        <a asp-action="Index" class="btn-secondary"
           data-open-tab data-close-current-tab data-tab="Pacientes" data-url='@Url.Action("Index", "Pacientes")'>Voltar</a>
    </div>
</section>

<div class="detail-grid">
    <article class="detail-card">
        <h2>Dados gerais</h2>
        <dl>
            <div>
                <dt>Código</dt>
                <dd>@Model.PacienteId</dd>
            </div>
            <div>
                <dt>Data de nascimento</dt>
                <dd>@Model.DataNascimento.ToString("dd/MM/yyyy")</dd>
            </div>
            <div>
                <dt>CPF/RG</dt>
                <dd>@(string.IsNullOrWhiteSpace(Model.CpfRg) ? "—" : Model.CpfRg)</dd>
            </div>
            <div>
                <dt>Responsável direto</dt>
                <dd>@(string.IsNullOrEmpty(Model.Responsavel) ? "—" : Model.Responsavel)</dd>
            </div>
            <div>
                <dt>Última atualização</dt>
                <dd>@Model.UltimaAtualizacao.ToString("dd/MM/yyyy")</dd>
            </div>
        </dl>
    </article>

    <article class="detail-card">
        <h2>Perfil clínico</h2>
        <dl>
            <div>
                <dt>Condições crônicas / comorbidades</dt>
                <dd>@(Model.CondicoesCronicas.Any() ? string.Join(", ", Model.CondicoesCronicas) : "—")</dd>
            </div>
            <div>
                <dt>Mobilidade e auxílios</dt>
                <dd>@(Model.MobilidadeAuxilios.Any() ? string.Join(", ", Model.MobilidadeAuxilios) : "—")</dd>
            </div>
            <div>
                <dt>Dietas e restrições</dt>
                <dd>@(Model.DietasRestricoes.Any() ? string.Join(", ", Model.DietasRestricoes) : "—")</dd>
            </div>
        </dl>
    </article>

    <article class="detail-card">
        <h2>Histórico clínico</h2>
        <dl>
            <div>
                <dt>Histórico cirúrgico</dt>
                <dd>@(Model.HistoricoCirurgico.Any() ? string.Join(", ", Model.HistoricoCirurgico) : "—")</dd>
            </div>
            <div>
                <dt>Risco de quedas</dt>
                <dd>@(Model.RiscoQuedas.Any() ? string.Join(", ", Model.RiscoQuedas) : "—")</dd>
            </div>
        </dl>
    </article>

    <article class="detail-card">
        <h2>Formulários recentes</h2>
        @if (!Model.FormulariosRecentes.Any())
        {
            <p class="empty-state">Nenhuma aplicação registrada.</p>
        }
        else
        {
            <ul class="list">
            @foreach (var formulario in Model.FormulariosRecentes)
            {
                <li>
                    <strong>@formulario.Formulario</strong>
                    <span>@formulario.DataAplicacao.ToString("dd/MM/yyyy") • @formulario.ResponsavelAplicacao</span>
                    <small>@formulario.Destaque</small>
                </li>
            }
            </ul>
        }
    </article>

</div>
